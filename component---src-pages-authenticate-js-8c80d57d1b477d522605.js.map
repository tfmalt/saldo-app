{"version":3,"sources":["webpack:///./src/components/LoadingSpinner.js","webpack:///./src/components/Authenticate.js","webpack:///./src/pages/authenticate.js"],"names":["LoadingSpinner","react_default","a","createElement","className","css","wrapper","spinner","Authenticate","props","_this","_React$Component","call","this","auth","window","userId","secret","JSON","parse","localStorage","getItem","state","isWaiting","handleSubmit","bind","assertThisInitialized_default","handleChange","_callee","event","res","json","regenerator_default","wrap","_context","prev","next","console","log","preventDefault","setState","fetch","urls","token","method","headers","Content-Type","body","stringify","grant_type","client_id","client_secret","sent","status","statusText","abrupt","ok","hasOwnProperty","warn","Error","date","Date","setItem","success","navigate","stop","newState","target","id","value","render","onSubmit","type","required","onChange","authenticate","hidden","visible","React","Component","AuthenticatePage","Layout","headerTitle","SEO","title","components_Authenticate"],"mappings":"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","file":"component---src-pages-authenticate-js-8c80d57d1b477d522605.js","sourcesContent":["import React from 'react'\nimport css from './LoadingSpinner.module.scss'\n\nexport default () => (\n  <div className={css.wrapper}>\n    <div className={css.spinner} />\n  </div>\n)\n","import React from 'react'\nimport { urls } from '../utils/settings'\nimport { navigate } from 'gatsby'\nimport Spinner from './LoadingSpinner'\nimport css from './Authenticate.module.scss'\n\nclass Authenticate extends React.Component {\n  constructor(props) {\n    super(props)\n\n    const auth =\n      typeof window === 'undefined'\n        ? { userId: '', secret: '' }\n        : JSON.parse(localStorage.getItem('sd60:authenticate'))\n\n    this.state = {\n      userId: auth === null ? '' : auth.userId,\n      secret: auth === null ? '' : auth.secret,\n      isWaiting: false,\n    }\n\n    this.handleSubmit = this.handleSubmit.bind(this)\n    this.handleChange = this.handleChange.bind(this)\n  }\n\n  async handleSubmit(event) {\n    console.log(`Got a submit! ${this.state.userId}`)\n    event.preventDefault()\n    this.setState({ isWaiting: true })\n\n    const res = await fetch(urls.token, {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        grant_type: 'client_credentials',\n        client_id: this.state.userId,\n        client_secret: this.state.secret,\n      }),\n    })\n\n    console.log('Got res:', res.status, res.statusText)\n\n    const json = await res.json()\n\n    this.setState({ isWaiting: false })\n\n    if (res.status === 400) {\n      // handle bad credentials.\n      console.log('Got wrong auth:', json)\n      return\n    }\n\n    if (res.ok) {\n      // lets be a bit paranoid\n      if (\n        !json.hasOwnProperty('access_token') ||\n        !json.hasOwnProperty('expires_in')\n      ) {\n        console.warn(json)\n        throw new Error(\n          'Something is not right with the access_token Response.'\n        )\n      }\n\n      json.date = new Date()\n      if (typeof window !== 'undefined') {\n        localStorage.setItem('sd60:token', JSON.stringify(json))\n        localStorage.setItem(\n          'sd60:authenticate',\n          JSON.stringify({\n            success: true,\n            userId: this.state.userId,\n            secret: this.state.secret,\n          })\n        )\n      }\n      return navigate('/')\n    }\n\n    throw new Error(`Got an invalid response. ${res.statusText}`)\n  }\n\n  handleChange(event) {\n    let newState = {}\n    newState[event.target.id] = event.target.value\n    this.setState(newState)\n  }\n\n  render() {\n    const { isWaiting } = this.state\n    return (\n      <div id=\"wrapper\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"textfield\">\n            <input\n              type=\"text\"\n              required\n              value={this.state.userId}\n              onChange={this.handleChange}\n              id=\"userId\"\n            />\n            <div id=\"underline\" />\n            <label>Bruker id</label>\n          </div>\n          <div className=\"textfield\">\n            <input\n              type=\"text\"\n              required\n              value={this.state.secret}\n              onChange={this.handleChange}\n              id=\"secret\"\n            />\n            <div id=\"underline\" />\n            <label>Passord</label>\n          </div>\n          <button className={css.authenticate} type=\"submit\" id=\"authenticate\">\n            <div className={isWaiting ? css.hidden : css.visible}>Logg inn</div>\n            <div className={isWaiting ? css.visible : css.hidden}>\n              <Spinner />\n            </div>\n          </button>\n        </form>\n      </div>\n    )\n  }\n}\nexport default Authenticate\n","import React from 'react'\nimport Layout from '../components/Layout'\nimport SEO from '../components/SEO'\nimport Authenticate from '../components/Authenticate'\n\nconst AuthenticatePage = () => (\n  <Layout headerTitle=\"Saldo - Logg inn\">\n    <SEO title=\"Authenticate\" />\n    <Authenticate />\n  </Layout>\n)\n\nexport default AuthenticatePage\n"],"sourceRoot":""}